This algorithms is correct for data computable in days, for example. It is very fast(O(N * sqrt(M)), but it's just an heuristic.
